<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <title>Blockschmiede | Adventskalender Showroom</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&family=Poppins:wght@500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=2.2.8">
    <link rel="icon" href="img/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#C62828">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6GTCTTYEX8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-6GTCTTYEX8');
    </script>
    <style>
        .showroom-form {
            margin-top: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            max-width: min(520px, 100%);
        }

        .showroom-form__field {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .showroom-form__label {
            font-weight: 600;
            letter-spacing: 0.02em;
            text-transform: uppercase;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .showroom-form__input {
            width: 100%;
            border-radius: 18px;
            border: 1px solid rgba(255, 255, 255, 0.28);
            background: rgba(17, 24, 39, 0.65);
            color: #fff;
            font: 500 1rem/1.2 "Manrope", "Poppins", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            padding: 1rem 1.25rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
        }

        .showroom-form__input::placeholder {
            color: rgba(255, 255, 255, 0.55);
        }

        .showroom-form__input:focus {
            outline: none;
            border-color: #FFD166;
            box-shadow: 0 0 0 4px rgba(255, 209, 102, 0.25);
            background: rgba(17, 24, 39, 0.82);
        }

        .showroom-form__actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            align-items: center;
        }

        .showroom-form__login {
            border: 0;
            border-radius: 999px;
            padding: 0.85rem 1.85rem;
            font: 600 1rem/1.1 "Poppins", "Manrope", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            background: linear-gradient(135deg, #F6AD55, #FFD166);
            color: #2D0C00;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
        }

        .showroom-form__login:hover,
        .showroom-form__login:focus-visible {
            transform: translateY(-1px);
            box-shadow: 0 16px 35px rgba(255, 209, 102, 0.35);
            filter: brightness(1.05);
        }

        .showroom-form__login:disabled,
        .showroom-form__login[aria-disabled="true"] {
            cursor: not-allowed;
            opacity: 0.55;
            box-shadow: none;
            filter: none;
        }

        .showroom-form__status {
            min-height: 1.2em;
            font-size: 0.95rem;
            font-weight: 500;
            color: rgba(255, 105, 105, 0.95);
        }

        .showroom-success__headline {
            text-transform: uppercase;
            letter-spacing: 0.25em;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 1rem;
        }

        .showroom-success__title {
            font-size: clamp(2.15rem, 4vw, 3rem);
            margin-bottom: 2rem;
        }

        .showroom-success__number {
            font-size: clamp(2.75rem, 5vw, 3.75rem);
            font-weight: 700;
            color: #FFD166;
            margin: 1.5rem 0 1rem;
        }

        .showroom-success__hint {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.05rem;
            max-width: 32ch;
            line-height: 1.6;
        }

        .showroom-success__email {
            margin-top: 1.5rem;
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.65);
        }

        .showroom-success__actions {
            margin-top: 2.25rem;
        }

        .showroom-download-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            min-width: 260px;
        }

        .showroom-download-button svg {
            width: 1.2em;
            height: 1.2em;
            fill: currentColor;
        }

        @media (min-width: 768px) {
            .showroom-form {
                flex-direction: row;
                align-items: center;
            }

            .showroom-form__field {
                flex: 1 1 auto;
                margin: 0;
            }

            .showroom-form__actions {
                flex-direction: row;
                align-items: stretch;
            }

            .showroom-form__status {
                width: 100%;
                order: 1;
            }
        }
    </style>
</head>

<body class="advent-page">
    <div class="snow-layer" data-snow aria-hidden="true"></div>

    <header class="site-header">
        <div class="top-bar">
            <a class="brand" href="index.html">
                <img src="img/logo.png?v=2026" alt="Blockschmiede Logo">
                <div class="brand-copy">
                    <span class="brand-name">Blockschmiede</span>
                    <span class="brand-subline">Bitcoin. Produkte. Kreativität.</span>
                </div>
            </a>
            <button class="nav-toggle" type="button" aria-expanded="false" aria-controls="primary-navigation">
                <span class="sr-only">Menü öffnen</span>
                <span class="nav-toggle-bar" aria-hidden="true"></span>
            </button>
            <nav class="main-nav" id="primary-navigation" aria-label="Hauptnavigation">
                <ul class="nav-list">
                    <li><a href="index.html">Start</a></li>
                    <li class="has-submenu">
                        <a href="produkte.html">Produkte</a>
                        <ul class="submenu">
                            <li><a href="legacy21.html">Legacy 21 Karte</a></li>
                            <li><a href="adventskalender.html">Adventskalender</a></li>
                        </ul>
                    </li>
                    <li><a href="unternehmen.html">Unternehmen</a></li>
                    <li><a href="https://shop.blockschmiede.com" target="_blank" rel="noopener noreferrer">Shop</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="advent-hero" id="showroom-start">
            <div class="advent-hero__content" data-animate data-showroom-content>
                <p class="advent-hero__headline">Bitcoin-Community for Charity 2025</p>
                <h1>Dein Zugang zum Adventskalender-Showroom</h1>
                <p class="advent-hero__subtitle">Gib deinen Kalendertoken ein, um den exklusiven Showroom freizuschalten und deine
                    persönliche Kalendernummer zu entdecken.</p>

                <div class="advent-hero__actions advent-hero__actions--premium">
                    <a class="advent-note__link advent-premium-button" href="https://shop.blockschmiede.com" target="_blank"
                        rel="noopener noreferrer">
                        <span class="advent-note__link-content">
                            <span class="advent-note__link-text">Adventskalender sichern</span>
                            <span class="advent-note__link-icon" aria-hidden="true">
                                <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
                                    <path d="M5 12h11.17l-3.58-3.59L13 7l6 6-6 6-1.41-1.41L16.17 13H5z" />
                                </svg>
                            </span>
                        </span>
                        <span class="advent-note__link-glow" aria-hidden="true"></span>
                    </a>
                </div>

                <form class="showroom-form" data-login-form>
                    <div class="showroom-form__field">
                        <label class="showroom-form__label" for="token-input">Kalendertoken</label>
                        <input class="showroom-form__input" type="text" id="token-input" name="token" autocomplete="off"
                            placeholder="Token eingeben" data-token-input>
                    </div>
                    <div class="showroom-form__actions">
                        <button type="submit" class="showroom-form__login" data-login-button aria-disabled="true" disabled>
                            Login
                        </button>
                        <span class="showroom-form__status" aria-live="polite" data-login-status></span>
                    </div>
                </form>
            </div>
            <div class="advent-hero__visual" data-animate style="--animate-delay: 0.12s;">
                <div class="advent-hero__showcase">
                    <p class="advent-hero__value advent-hero__value--centered"><strong>Dein Zugang</strong><span>zum
                            Adventskalender</span></p>
                    <figure class="advent-hero__figure">
                        <img src="img/geschenkBtc.png?v=2026" alt="Illustration eines geöffneten Adventskalenders mit fliegenden Geschenken">
                    </figure>
                </div>
            </div>
        </section>
    </main>

    <div class="advent-hero__sentinel" data-calendar-sentinel aria-hidden="true"></div>

    <script>
        (function () {
            const navToggle = document.querySelector('.nav-toggle');
            const navigation = document.querySelector('.main-nav');
            if (!navToggle || !navigation) {
                return;
            }

            const body = document.body;
            const toggleLabel = navToggle.querySelector('.sr-only');

            const closeMenu = () => {
                navToggle.setAttribute('aria-expanded', 'false');
                navigation.classList.remove('is-open');
                body.classList.remove('nav-open');
                if (toggleLabel) {
                    toggleLabel.textContent = 'Menü öffnen';
                }
            };

            navToggle.addEventListener('click', () => {
                const isOpen = navToggle.getAttribute('aria-expanded') === 'true';
                navToggle.setAttribute('aria-expanded', String(!isOpen));
                navigation.classList.toggle('is-open');
                body.classList.toggle('nav-open');
                if (toggleLabel) {
                    toggleLabel.textContent = isOpen ? 'Menü öffnen' : 'Menü schließen';
                }
            });

            window.addEventListener('keyup', (event) => {
                if (event.key === 'Escape') {
                    closeMenu();
                }
            });

            navigation.querySelectorAll('a').forEach((link) => {
                link.addEventListener('click', closeMenu);
            });
        })();

        (function () {
            const animatedElements = document.querySelectorAll('[data-animate]');
            if (!animatedElements.length || !('IntersectionObserver' in window)) {
                animatedElements.forEach((element) => {
                    element.classList.add('is-visible');
                });
                return;
            }

            const observer = new IntersectionObserver((entries, obs) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        obs.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.2,
                rootMargin: '0px 0px -40px 0px'
            });

            animatedElements.forEach((element) => observer.observe(element));
        })();

        (function () {
            const snowContainer = document.querySelector('[data-snow]');
            if (!snowContainer) {
                return;
            }
            const prefersReducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            if (prefersReducedMotion) {
                return;
            }
            const flakeCount = 60;
            const createFlake = () => {
                const span = document.createElement('span');
                span.style.setProperty('--x', `${(Math.random() * 40 - 20).toFixed(2)}px`);
                span.style.left = `${(Math.random() * 100).toFixed(2)}%`;
                span.style.animationDuration = `${(8 + Math.random() * 8).toFixed(2)}s`;
                span.style.animationDelay = `${(-Math.random() * 12).toFixed(2)}s`;
                span.style.opacity = `${(0.35 + Math.random() * 0.5).toFixed(2)}`;
                const size = 4 + Math.random() * 6;
                span.style.width = `${size.toFixed(2)}px`;
                span.style.height = `${size.toFixed(2)}px`;
                snowContainer.appendChild(span);
            };
            for (let i = 0; i < flakeCount; i += 1) {
                createFlake();
            }
        })();

        (function () {
            const showroomContent = document.querySelector('[data-showroom-content]');
            const tokenInput = document.querySelector('[data-token-input]');
            const loginButton = document.querySelector('[data-login-button]');
            const loginStatus = document.querySelector('[data-login-status]');
            const loginForm = document.querySelector('[data-login-form]');
            if (!showroomContent || !tokenInput || !loginButton || !loginStatus || !loginForm) {
                return;
            }

            const API_ENDPOINT = 'https://dev.infinity-impact.com/blockschmiede/api/login';
            const defaultButtonText = loginButton.textContent;

            const updateButtonState = () => {
                const hasToken = tokenInput.value.trim().length > 0;
                loginButton.disabled = !hasToken;
                loginButton.setAttribute('aria-disabled', hasToken ? 'false' : 'true');
            };

            const params = new URLSearchParams(window.location.search);
            const presetToken = params.get('token');
            if (presetToken) {
                tokenInput.value = presetToken;
                updateButtonState();
            }

            tokenInput.addEventListener('input', () => {
                loginStatus.textContent = '';
                updateButtonState();
            });

            const setLoadingState = (isLoading) => {
                if (isLoading) {
                    loginButton.disabled = true;
                    loginButton.setAttribute('aria-disabled', 'true');
                    loginButton.textContent = 'Wird geprüft...';
                } else {
                    loginButton.textContent = defaultButtonText;
                    updateButtonState();
                }
            };

            const renderSuccessView = (data) => {
                const kalenderNummerValue = data?.kalendernummer ?? data?.kalenderNummer;
                const kalenderNummer = kalenderNummerValue ? String(kalenderNummerValue) : '–';
                const email = data?.email || data?.Email;

                showroomContent.innerHTML = `
                    <div class="showroom-success" data-animate>
                        <p class="showroom-success__headline">Willkommen im Adventskalender-Showroom</p>
                        <h1 class="showroom-success__title">BITCOIN-COMMUNITY FOR CHARITY 2025</h1>
                        <p class="showroom-success__number">Dein Kalender trägt die Nummer: ${kalenderNummer}</p>
                        <p class="showroom-success__hint">Sei vom 01.12.2025 bis zum 24.12.2025 jeden Tag gespannt, ob deine Nummer gewinnt. Verfolge unsere Social Media Kanäle oder warte hier im Showroom auf die Verlosung.</p>
                        ${email ? `<p class="showroom-success__email">Verknüpfte E-Mail-Adresse: ${email}</p>` : ''}
                        <div class="advent-hero__actions advent-hero__actions--premium showroom-success__actions">
                            <a class="advent-note__link advent-premium-button showroom-download-button" href="/img/Adventskalender.pdf" download="Blockschmiede-Adventskalender-2025.pdf" target="_blank" rel="noopener">
                                <span class="advent-note__link-content">
                                    <span class="advent-note__link-text">Adventskalender herunterladen</span>
                                    <span class="advent-note__link-icon" aria-hidden="true">
                                        <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
                                            <path d="M5 20h14v-2H5v2zm7-18L5.33 9.67 6.75 11.1 11 6.83V16h2V6.83l4.25 4.26 1.42-1.43L12 2z" />
                                        </svg>
                                    </span>
                                </span>
                                <span class="advent-note__link-glow" aria-hidden="true"></span>
                            </a>
                        </div>
                    </div>
                `;
                const successSection = showroomContent.querySelector('.showroom-success');
                if (successSection) {
                    successSection.classList.add('is-visible');
                }
            };

            loginForm.addEventListener('submit', async (event) => {
                event.preventDefault();
                loginStatus.textContent = '';
                const token = tokenInput.value.trim();
                if (!token) {
                    return;
                }

                setLoadingState(true);

                try {
                    const response = await fetch(API_ENDPOINT, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ token })
                    });

                    let result = null;
                    try {
                        result = await response.json();
                    } catch (parseError) {
                        result = null;
                    }

                    if (!response.ok) {
                        const message = (result && (result.message || result.error)) || 'Ungültige Antwort vom Server';
                        throw new Error(message);
                    }

                    if (!result || (!result.kalendernummer && !result.kalenderNummer)) {
                        throw new Error('Token konnte nicht verifiziert werden.');
                    }

                    renderSuccessView(result);
                } catch (error) {
                    loginStatus.textContent = error.message || 'Die Anmeldung ist fehlgeschlagen. Bitte versuche es erneut.';
                } finally {
                    setLoadingState(false);
                }
            });

            updateButtonState();
        })();
    </script>
</body>

</html>
